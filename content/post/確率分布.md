---
title: 確率分布
author: ~
date: '2020-03-24'
slug: prob
categories: [統計]
tags: []
Description: ''
menu: ''
---


```python
# 自動補完設定
%config IPCompleter.greedy=True
```

# 標準化
平均を０、標準偏差（分散）を１に変換すること
$$
x  \longmapsto \frac{x - \overline{x}}{s}
$$

ちなみに偏差値は標準化変量の平均を50、標準偏差を10に修正している。
$$
x  \longmapsto \frac{10(x - \overline{x})}{s}+50
$$

# 正規分布(ガウス分布)(誤差分布)
確率密度関数  
$$
f(x) = \frac{1}{\sqrt{2\pi \sigma^2}} \exp \left(-\frac{(x - \mu)^2}
{2\sigma^2} \right) \hspace{20px} (-\infty < x < \infty)
$$
データの平均が０、標準偏差が１に標準化された正規分布を標準正規分布（ｚ分布）と呼ぶ



```python
import matplotlib.pyplot as plt
import numpy as np
from scipy.stats import norm

x = np.arange(-10,10,0.2)
# nrom,pdfは期待値`loc`、標準偏差`scale`の正規分布の確率密度関数のx辞典の値を取得する
p_1 = norm.pdf(x, loc = 0, scale =1)  # 標準正規分布（ｚ分布）N(0,1)
p_2 = norm.pdf(x, 0, 2)
p_3 = norm.pdf(x, 2, 1)
p_4 = norm.pdf(x, 2, 2)

plt.plot(x,p_1, color="blue")
plt.plot(x,p_2, color="orange")
plt.plot(x,p_3, color="green")
plt.plot(x,p_4, color="red")
plt.show()
```


![png](output_4_0.png)


## フィッティング


```python
from scipy.stats import norm
import numpy as np
import matplotlib.pyplot as plt
import pylab as plb

# 正規分布に近似したサンプルを得る
# 平均は 100 、標準偏差を 1 、サンプル数を 500 とする
sample = norm.rvs(loc=100,scale=1,size=500)

print (sample)

param = norm.fit(sample)

print (param)

x = np.linspace(95,105,100)
pdf_fitted = norm.pdf(x,loc=param[0], scale=param[1])
pdf = norm.pdf(x)
plt.figure
plt.title('Normal distribution')
plt.plot(x, pdf_fitted, 'r-', x,pdf, 'b-')
plt.hist(sample, normed=1, alpha=.3)
plt.show()
plt.savefig("image.png")
```

    [100.32046779  99.7159406   99.80301537 100.32889337 101.74150624
     100.78542031 100.07731484 100.4504283   99.62616038  99.28714955
     101.43176018  99.03225989  99.84523634  99.50232666 100.66782098
     100.0436182  100.33383224  99.49784824  98.99002296 100.72751532
      99.43482734  98.299936    99.15540924 100.05310795  98.6455371
     100.08820259 100.22156987 100.59185016  98.48686561  99.69504235
     100.72687974 100.13092856  99.46255969  98.73030803 101.28832367
      99.60997944 101.23934669  99.22683659  99.04595455  99.70197214
     100.30585066 100.40566795  99.88883486  98.48891433  98.92772086
      99.16462534 100.52799269  98.6787649   99.73807914  98.29445819
     100.61227706  99.64951759 101.06640124 100.17278792 100.49435266
     100.95924873 100.19981759 100.70659352  98.94954943  97.95237943
      98.90532613  98.82366084 100.62965384  99.39107661 100.05812199
     100.84225199 101.00287196  98.71053554  99.78311311  99.51673744
     100.0323469   99.96034903  98.23226492  99.89387057  98.90517983
      98.63783221  99.36218978  98.0129517   98.77585749  99.62860268
     101.2711299   98.82464961  99.48630911 101.43849069  99.28632565
      99.38989999  98.7425325   97.53086509  99.86471067 100.54506332
      99.34652477  99.76921545 101.82194417  98.75140501 100.38086154
      99.07993858 100.25513642 100.76393254 100.33039565  99.12285029
      99.35777434  98.77823213 101.34232244 100.14378829  99.29304179
      99.34327302  99.57149327 101.70238971 100.05250879  98.93765941
     100.61834759 101.79044072 100.935671    99.28776252  99.74957596
      99.47240731 101.1683304  100.93370174  99.49051973 100.92739209
     100.12089161  99.98001522  99.487646    98.54496857 100.24941508
      97.97478661  99.31287925 101.0987453   99.79092781  98.1261557
     100.16255602 100.73892016 100.65366654 101.71105841  99.56132572
     100.17225627  98.57212452 100.56750015 100.07605174 101.1219081
      99.20859028 101.52099849 100.43902506  98.87749022  98.66471636
     102.60066191  99.93167616  98.64560807  99.22622748  99.02890372
     100.16596128 101.06570685 100.92697019  97.4131338   99.07098661
     100.28184352 100.04646082  99.94111718  99.54751142 101.63557896
      98.68838068  99.53542523  99.05432706 100.99421578 100.30786252
      99.40358449 101.52456407  99.1292011   99.16820172  99.03239951
      98.23417674  99.78272856 100.09211334  98.5389205   98.7163796
     100.13554519  99.04963846  99.36431215  98.2720406   99.24797111
     100.9837254   99.10645987 100.25429388  99.65194762  99.37241422
     100.55146884  99.85727208  98.8298444   98.52782845 100.09447301
     100.7080354   98.83949477  98.80270233 100.8164845   98.95670451
     101.97560148 100.5874842  101.38580546 100.10646243 100.12533483
     100.01830696  99.15386834  99.70010913 102.60101123 100.53004956
      99.51099542  99.96449754  99.11284476 100.49289757  98.88480267
      99.10063172 101.30668301  98.31623405  99.96039875 101.16000158
      99.31016802  97.85099572  98.5590177  100.85101038 101.16921984
     100.60980508  99.38242394 100.35340906 100.6755446  100.57904921
     100.77301559 100.50492861 100.52854356 101.81708092 100.29689024
     100.14697181  99.9880956   99.80033498 101.03909946  99.67925321
      99.86944337  99.96740957 101.06620824 100.83325415 100.95301485
      98.9632836  101.45647299 100.69252045 100.99668826 100.16803689
     101.03823887 100.26168996 100.50559528  99.45477682  99.94321034
     101.15135718  98.88723748 100.49698046  98.75057841  99.69080137
     100.06592248  98.92164251  99.47637871  98.56026455  99.46707272
      99.71574935 100.07370637  99.9646212  100.94793865 100.39670491
     100.03434723  99.08050243  99.07494371  99.50068521 101.22355571
     100.78707915 100.50243627  98.69601395  98.91720999 100.05998151
      99.53914701 101.61385507 100.55303671  98.52753321 100.4693106
     101.00391403  98.55078117 100.46628281 101.01143107 100.38737039
      98.67398816  99.23954111 100.95136682 100.52012884 101.64739272
     101.68010261  99.96364695 100.84197596  98.65827327 101.05758682
      99.60466901  99.54167862 101.98628626 100.97454326  98.71262454
      98.36349246  98.12747175  99.82600176  98.50591126 100.64159018
     100.89068962  99.27904518  99.11246501 100.92818709 100.17858071
      99.88914163  98.96377642 100.02468929 100.22193098  98.73573713
     100.75749944 100.62958341  98.43306863 101.79052094  98.70757132
     101.34556655 100.35828576 101.0562037   99.7816637   99.28655804
      99.1054612  101.19271616  99.08786924 100.8864758   98.49758661
      98.50951949 101.25315954 101.6162302  101.45256813 100.78583658
     100.71001165 100.39073991 101.73875443 100.17984906  98.77172941
      99.59469645 100.35904395  99.56437968  98.95661102 100.96307776
     101.33219997  99.22468378  99.74588613 100.11005386 100.7297944
     100.09443079 101.06354651 101.1687635   99.25418306 101.18539213
      99.62377004 102.21917018  99.92629193 100.83770132  99.79540558
     100.31815755 100.6560326   98.94193341 101.05842787 100.74818169
     100.02073077  99.10431317 100.15464297  99.86606152 100.96207143
      99.799888    99.59213758  99.05471619 100.9705314   99.89700698
     101.03536302  98.11618081  99.39233781 100.54597881  99.54306065
     100.15907357  99.07843496  99.35476968  99.79645461  99.49209394
      99.03996704  99.39400354  99.85330576 101.15490872 100.67589128
      99.73391551 101.04362798  99.72977102 100.30268215  98.76624561
     100.59115792  99.69286398  99.68597341  99.28984376  98.08594747
      99.97837607 100.96425026 100.32578201  99.12309949 100.06384152
      98.15284161  98.84420071  98.85554601  99.78426031  99.83278413
      99.66344578 102.31780573 100.63272943 100.39388104  99.40317924
     100.26420114 101.40522234 100.32443906  99.60275308 100.10283287
      99.45030173 101.80644992  99.81980397 101.11173157  99.55147649
      99.65417086 100.35373251  99.4756376  100.43518187  99.20770515
     100.37489719  99.31550248 100.45627427  98.95317471 100.8888714
      99.97289392 102.21330773 100.22421704  98.55038407 100.2988993
      99.90286999  99.69833754 100.21824296 101.00497196  99.40508646
     100.35706975 100.3300047   99.62813467  99.66129876  98.17528126
      99.42917417 100.55912023  99.87971653  99.13455805 100.67504642
      99.98251559  98.90457552  99.1247441   99.76088745  99.32173067
     101.71555293  99.09187266 102.30328268 100.33042436 100.63145974
     101.41118883 100.80124643 100.93631522 100.06333602 101.14757043
     100.54254276  98.04129546 100.63993501 100.69317906  98.97319939
     100.84774528  99.13968866 101.23412854  99.9303675  100.17868445
      98.93415926 100.07881744 100.52672385 100.14117808 100.40649336
      98.81450784 101.17890752  99.46526918 100.88030871 102.21595562
     102.5650218  100.68956012  99.97321175 101.08222493 100.44074697
      98.55066202 101.7272674  100.6648325  100.99598505  98.16541145]
    (99.97546728461529, 0.9603643901666323)
    

    C:\ProgramData\Anaconda3\envs\test\lib\site-packages\ipykernel_launcher.py:22: MatplotlibDeprecationWarning: 
    The 'normed' kwarg was deprecated in Matplotlib 2.1 and will be removed in 3.1. Use 'density' instead.
    


![png](output_6_2.png)



    <Figure size 432x288 with 0 Axes>


# 歪度・尖度
## 歪度
$$
\frac{\sqrt{n} \displaystyle \sum_{i = 1}^n (x_i - \overline{x})^3}
{\left( \displaystyle \sum_{i = 1}^n
(x_i - \overline{x})^2 \right)^{\frac{3}{2}}}
$$


```python
import numpy as np
import scipy
x = [1,2,3,4,5,6,7,8,9]
a = [1,3,5,7,9,7,5,3,1]

skewa = scipy.stats.skew(a)
print('歪度: {0:.2f}'.format(skewa))

plt.plot(x, a)
plt.title('skew: {0:.2f}'.format(skewa))
```

    歪度: 0.12
    




    Text(0.5, 1.0, 'skew: 0.12')




![png](output_8_2.png)



```python
b = [1,5,11,7,5,2,1,0,2]
skewb = scipy.stats.skew(b)
print('歪度: {0:.2f}'.format(skewb))

plt.plot(x, b)
plt.title(skewb)
```

    歪度: 0.90
    




    Text(0.5, 1.0, '0.8964100418495498')




![png](output_9_2.png)



```python
c = [2,0,1,2,5,7,11,5,1]

skewc = scipy.stats.skew(c)
print('歪度: {0:.2f}'.format(skewc))

plt.plot(x, c)
plt.title(skewc)
```

    歪度: 0.90
    




    Text(0.5, 1.0, '0.8964100418495499')




![png](output_10_2.png)


## 尖度
$$
\displaystyle \frac{n\displaystyle \sum_{i = 1}^n (x_i - \overline{x})^4}
{\left( \displaystyle \sum_{i = 1}^n (x_i - \overline{x})^2 \right)^2}
$$


```python
x = [1,3,5,7,9,7,5,3,1]
kurtosis = scipy.stats.kurtosis(x)
print('尖度: {0:.2f}'.format(kurtosis))
```

    尖度: -1.16
    


```python
x = [1,5,11,7,5,2,1,0,2]
kurtosis = scipy.stats.kurtosis(x)
print('尖度: {0:.2f}'.format(kurtosis))
```

    尖度: -0.23
    


```python
x = [2,0,1,2,5,7,11,5,1]
kurtosis = scipy.stats.kurtosis(x)
print('尖度: {0:.2f}'.format(kurtosis))
```

    尖度: -0.23
    
